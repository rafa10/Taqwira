{% if fields is defined %}

    {% for field in fields %}
        <div class="card">
            <div class="card-content row">
                <div class="col s3">
                    <span class="card-title"><i class="medium material-icons left">view_array</i> {{ field.name }}</span>
                </div>
                <div class="col s6">
                    <p><i class="tiny material-icons ">info_outline</i> <b>Capacité</b>: {{ field.capacity }} joueurs</p>
                    <p>
                        {% set hideClass = null %}
                        {% for planning in field.planning if planning.field.id == field.id %}
                            <i class="tiny material-icons">event_available</i> <b>Période</b>: De <b>{{ planning.dateStart|date('d/m/Y') }}</b> à <b>{{ planning.dateEnd|date('d/m/Y') }}</b>
                        {% else %}
                            {% set hideClass = 'hide' %}
                            <i class="tiny material-icons">event_available</i> <b>Période</b>: <span class="red-text"><i class="material-icons">warning</i> Non disponible</span>
                        {% endfor %}
                    </p>
                </div>
                <div class="col s3"><span class="btn disabled" style="color: #000 !important;">{% if 'now'|date('Y-m-d') == date_search|date('Y-m-d') %}Aujourd'hui{% else %}{{ date_search|date('l') }}, {{ date_search|date('d-m-Y') }}{% endif %}</span></div>
            </div>
            {#==== calculer de nombre des jours dans le  planning =============================#}
            {% for planning in field.planning if planning.field.id == field.id %}
                {#===========================================================================================#}
                {#=== Si la date est inferieur a la date de fin de planning =================================#}
                {#===========================================================================================#}
                {% if planning.dateStart|date('U') > date_search|date('U') %}
                    <div class="card-action center grey lighten-5">
                        <span class="red-text">~~{#<i class="mdi-alert-warning"></i>#} Aucun résultat trouvé ! ~~</span>
                    </div>
                    {#===========================================================================================#}
                    {#=== Si la date d'aujourd'hui est superieur ================================================#}
                    {#===========================================================================================#}
                {% elseif 'now'|date('U') > date_search|date('U') %}
                    <div class="card-action center grey lighten-5">
                        <span class="red-text">~~{#<i class="mdi-alert-warning"></i>#} Aucun résultat trouvé ! ~~</span>
                    </div>
                    {#===========================================================================================#}
                    {#=== Si la date est superieur a la date de fin de planning =================================#}
                    {#===========================================================================================#}
                {% elseif planning.dateEnd|date('Y-m-d') < date_search|date('Y-m-d') %}
                    <div class="card-action center grey lighten-5">
                        <span class="red-text">~~{#<i class="mdi-alert-warning"></i>#} Aucun résultat trouvé ! ~~</span>
                    </div>
                    {#===========================================================================================#}
                    {#========================================== End ============================================#}
                    {#===========================================================================================#}
                {% else %}
                    {#==========================================================================================#}
                    {#=== Si c'est la date d'aujourd'huit ======================================================#}
                    {#==========================================================================================#}
                    {% set nowColor = 'grey lighten-4' %}
                    <div class="card-action center session-day-{{ field.id }} {{ nowColor }}">
                        <span class="center-align">
                        {% if "now"|date('Y-m-d') == date_search|date('Y-m-d') %}
                            {% for day in days %}
                                {% if day.name == date_search|date('l') %}
                                    {% for price in day.Price %}
                                        {% for sessionP in price.Session %}
                                            {% for sessionF in field.session %}
                                                {% if sessionF.id == sessionP.id %}
                                                    {% if sessionF.timeStart|date('H:i') >= 'now'|date('H:i') %}
                                                        {% set bookSelected %} <a class="tooltipped modal_trigger" data-position="top" data-delay="50" data-tooltip="{{ price.amount }}€" href="{{ path('booking_details', {'field': field.id | urlencrypt ,'date': date_search|date('Y-m-d') | urlencrypt , 'timeS': sessionF.timeStart|date('H:i') | urlencrypt, 'timeE': sessionF.timeEnd|date('H:i') | urlencrypt, 'price': price.amount | urlencrypt }) }}"><div class="chip waves-effect waves-light lime"><i class="tiny material-icons">timer</i>  {{ sessionF.timeStart|date('H:i') }}</div></a> {% endset %}
                                                        {% for booking in bookings if booking.field.id == field.id %}
                                                        {% if booking.date|date('Y-m-d') == date_search|date('Y-m-d') and booking.timeStart|date('H:i') == sessionF.timeStart|date('H:i') %}
                                                            {% set bookSelected %} <a class="disabled"><div class="chip red lighten-1 red-text text-lighten-4"><i class="tiny material-icons">timer</i>  {{ sessionF.timeStart|date('H:i') }}</div></a> {% endset %}
                                                        {% endif %}
                                                    {% endfor %}
                                                        {{ bookSelected }}
                                                    {% else %}
                                                        <a class="disabled"><div class="chip"><i class="tiny material-icons">timer</i>  {{ sessionF.timeStart|date('H:i') }}</div></a>
                                                    {% endif %}
                                                {% endif %}
                                            {% endfor %}
                                        {% endfor %}
                                    {% endfor %}
                                {% endif %}
                            {% endfor %}
                        {% else %}
                            {% for day in days %}
                                {% if day.name == date_search|date('l') %}
                                    {% for price in day.Price %}
                                        {% for sessionP in price.Session %}
                                            {% for sessionF in field.session %}
                                                {% if sessionF.id == sessionP.id %}
                                                    {% set bookSelected %} <a class="tooltipped modal_trigger" data-position="top" data-delay="50" data-tooltip="{{ price.amount }}€" href="{{ path('booking_details', {'field': field.id | urlencrypt ,'date': date_search|date('Y-m-d') | urlencrypt , 'timeS': sessionF.timeStart|date('H:i') | urlencrypt, 'timeE': sessionF.timeEnd|date('H:i') | urlencrypt, 'price': price.amount | urlencrypt }) }}"><div class="chip waves-effect waves-light lime"><i class="tiny material-icons">timer</i>  {{ sessionF.timeStart|date('H:i') }}</div></a> {% endset %}
                                                {% for booking in bookings if booking.field.id == field.id %}
                                                    {% if booking.date|date('Y-m-d') == date_search|date('Y-m-d') and booking.timeStart|date('H:i') == sessionF.timeStart|date('H:i') %}
                                                        {% set bookSelected %} <a class="disabled"><div class="chip red lighten-1 red-text text-lighten-4"><i class="tiny material-icons">timer</i>  {{ sessionF.timeStart|date('H:i') }}</div></a> {% endset %}
                                                    {% endif %}
                                                {% endfor %}
                                                    {{ bookSelected }}
                                                {% endif %}
                                            {% endfor %}
                                        {% endfor %}
                                    {% endfor %}
                                {% endif %}
                            {% endfor %}
                        {% endif %}
                        </span>
                    </div>
                    {#===========================================================================================#}
                    {#========================================== End ============================================#}
                    {#===========================================================================================#}
                {% endif %}
            {% endfor %}
        </div>
    {% endfor %}

{% else %}

    <div id="preloader-page-content" class="card-panel center-align z-depth-0" style="position: absolute; top: 40%; left: 40%;">
        <div class="preloader-wrapper small active">
            <div class="spinner-layer spinner-blue-only">
                <div class="circle-clipper left">
                    <div class="circle"></div>
                </div><div class="gap-patch">
                    <div class="circle"></div>
                </div><div class="circle-clipper right">
                    <div class="circle"></div>
                </div>
            </div>
        </div><br>S'il vous plaît, attendez...
    </div>

{% endif %}